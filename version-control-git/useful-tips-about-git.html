

<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Useful Tips about Git &mdash; Today I Learnt  文档</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/translations.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="Branch Name Contain The ‘space’ Char" href="branch-name-contain-the-space-char.html" />
    <link rel="prev" title="Git Glossary" href="git-glossary.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Today I Learnt
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="在文档中搜索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../cs-and-web-concepts/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.html">计算机网络</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cs-and-web-concepts/dns.html">DNS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cs-and-web-concepts/%E7%A7%91%E6%8A%80%E8%8B%B1%E8%AF%AD.html">科技英语</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cs-and-web-concepts/front-end-and-its-history.html">Front-end and its history</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cs-and-web-concepts/cors.html">CORS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cs-and-web-concepts/how-the-web-works.html">How the Web works</a></li>
<li class="toctree-l1"><a class="reference internal" href="../algorithms-and-data-structure/books.html">一些算法书籍</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operating-system/linux-details.html">Linux Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operating-system/linux-common-orders.html">Linux Common Orders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operating-system/arch-system-maintenance.html">Arch System Maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operating-system/arch-package.html">Arch Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operating-system/arch-software-installation-and-usage.html">Arch Software Installation and Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operating-system/arch-installation-guide.html">Arch Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operating-system/openbsd-installation.html">OpenBSD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operating-system/ubuntu-backup.html">Ubuntu Backup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operating-system/ubuntu-common-usage.html">Ubuntu Common Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operating-system/ubuntu-install-software.html">Install Software on Ubuntu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operating-system/ubuntu-problems.html">Problems on Ubuntu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operating-system/mxlinux-installation.html">MX Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../html/before-html.html">Before HTML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../html/html-basics.html">HTML Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../html/images.html">Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../html/html-code-snippets.html">HTML Code Snippets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../css/css-basics.html">CSS Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../css/css-box.html">CSS Box</a></li>
<li class="toctree-l1"><a class="reference internal" href="../css/css-position.html">CSS Position</a></li>
<li class="toctree-l1"><a class="reference internal" href="../css/css-code-snippets.html">CSS Code Snippets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript/javascript-basics.html">JavaScript Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript/es6.html">ES6</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript/what-i-learnt-from-js.html">What I learnt from JS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript/install-node-npm-yarn.html">Install Node.js, NPM and Yarn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript/yarn-v2-usage.html">Yarn v2 Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript/used-packages-from-npm-or-yarn.html">Used Packages from npm or yarn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript/the-difference-between-js-in-head-and-body.html">The difference between js in the head and body</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript/js-code-snippets.html">JS Code Snippets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vue/vue.html">Vue</a></li>
<li class="toctree-l1"><a class="reference internal" href="../front-end.html">Front-end</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programming-languages/shell.html">Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programming-languages/python.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programming-languages/go.html">Go</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projects/wordpress.html">WordPress</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/docker.html">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/vagrant.html">Vagrant</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/gpg.html">GPG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/jekyll.html">Jekyll</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/hugo.html">Hugo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/vim.html">vim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/cloudflare.html">Cloudflare</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/gatsby.html">Gatsby</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/sphinx.html">Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="git-fundamentals.html">Git Fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="git-commit.html">Git Commit</a></li>
<li class="toctree-l1"><a class="reference internal" href="commit-messages-guide.html">Commit Messages Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="git-and-gitHub.html">Git and GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="git-command-line-reference.html">Git Command Line Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="git-glossary.html">Git Glossary</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Useful Tips about Git</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">多人合作开发</a></li>
<li class="toctree-l2"><a class="reference internal" href="#git-flow">使用 git-flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rename-branch">Rename Branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rename-the-origin-remote-to-upstream">Rename The <code class="docutils literal notranslate"><span class="pre">origin</span></code> Remote To <code class="docutils literal notranslate"><span class="pre">upstream</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#reset">Reset</a></li>
<li class="toctree-l2"><a class="reference internal" href="#see-a-file-at-a-specific-commit">See A File At A Specific Commit</a></li>
<li class="toctree-l2"><a class="reference internal" href="#show-helpful-guides-that-come-with-git">Show Helpful Guides That Come With Git</a></li>
<li class="toctree-l2"><a class="reference internal" href="#show-the-latest-commit">Show The Latest Commit</a></li>
<li class="toctree-l2"><a class="reference internal" href="#use-format-patch-to-suggest-code-changes">Use <code class="docutils literal notranslate"><span class="pre">format</span> <span class="pre">patch</span></code> To Suggest Code Changes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#what-will-be-done-after-rename-branch-on-github">What Will Be Done After Rename Branch On GitHub</a></li>
<li class="toctree-l2"><a class="reference internal" href="#commit-message">commit message 规范</a></li>
<li class="toctree-l2"><a class="reference internal" href="#git-rebase-commit">使用 git rebase 来合并你的 commit</a></li>
<li class="toctree-l2"><a class="reference internal" href="#git-pull-rebase"><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span> <span class="pre">--rebase</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#id4">分支合并</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#main">场景：基于 main 分支代码，开发新特性</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">场景：合并分支时，存在分叉</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">场景：解决合并冲突</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id7">其他</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id8">修改密码</a></li>
<li class="toctree-l3"><a class="reference internal" href="#push-commit">修改已经 push 的某次 commit 的作者/邮箱</a></li>
<li class="toctree-l3"><a class="reference internal" href="#branch1-commit1-branch2">将 <code class="docutils literal notranslate"><span class="pre">branch1</span></code> 的某个 <code class="docutils literal notranslate"><span class="pre">commit1</span></code> 合并到 <code class="docutils literal notranslate"><span class="pre">branch2</span></code> 当中</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">将 Git 项目迁移到另一个仓库</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="branch-name-contain-the-space-char.html">Branch Name Contain The ‘space’ Char</a></li>
<li class="toctree-l1"><a class="reference internal" href="create-empty-branch-locally-and-remotely.html">Create Empty Branch Locally And Remotely</a></li>
<li class="toctree-l1"><a class="reference internal" href="delete-a-git-branch-both-locally-and-remotely.html">Delete A Git Branch Both Locally And Remotely</a></li>
<li class="toctree-l1"><a class="reference internal" href="delete-all-local-and-remote-tags.html">Delete All Local And Remote Tags</a></li>
<li class="toctree-l1"><a class="reference internal" href="delete-commit.html">Delete Commit</a></li>
<li class="toctree-l1"><a class="reference internal" href="merge-two-git-repo.html">Merge Two Git Repo</a></li>
<li class="toctree-l1"><a class="reference internal" href="remove-tracking-branches-no-longer-on-remote.html">Remove Tracking Branches No Longer On Remote</a></li>
<li class="toctree-l1"><a class="reference internal" href="update-with-original-repo-after-forking-on-github.html">Update With Original Repo After Forking on GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="git-clone-specify-branch.html">Git Clone Specify Branch</a></li>
<li class="toctree-l1"><a class="reference internal" href="github-action-only-generate-nojekyll.html">GitHub Action only Generate <code class="docutils literal notranslate"><span class="pre">.nojekyll</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../useful-info.html">Useful Info</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hardware/bluetooth.html">Bluetooth</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hardware/power-supply-unit.html">Power supply unit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hardware/raspberry-pi.html">Raspberry Pi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../learning-how-to-learn.html">Learning How to Learn</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Today I Learnt</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Useful Tips about Git</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/tianheg/til/blob/main/content/version-control-git/useful-tips-about-git.rst" class="fa fa-github"> 在 GitHub 上修改</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="useful-tips-about-git">
<h1>Useful Tips about Git<a class="headerlink" href="#useful-tips-about-git" title="永久链接至标题">¶</a></h1>
<div class="section" id="id1">
<h2>多人合作开发<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h2>
<p>如果要开发多人合作项目，我们建议将 master 分支设置为 <a class="reference external" href="https://help.github.com/en/articles/configuring-protected-branches">protected</a> 分支，使得不允许直接在 master 上提交代码，只能通过 PR 的形式来合并。如何向项目提交 PR 请参考 <a class="reference external" href="https://www.zhihu.com/question/21682976/answer/79489643">GitHub 的 Pull Request 是指什么意思？</a></p>
</div>
<div class="section" id="git-flow">
<h2>使用 git-flow<a class="headerlink" href="#git-flow" title="永久链接至标题">¶</a></h2>
<p>使用 <a class="reference external" href="https://www.git-tower.com/learn/git/ebook/cn/command-line/advanced-topics/git-flow">git-flow)</a> 这个工具可以帮助我们更好的控制我们的工作流程</p>
</div>
<div class="section" id="rename-branch">
<h2>Rename Branch<a class="headerlink" href="#rename-branch" title="永久链接至标题">¶</a></h2>
<blockquote>
<div><p>git branch -m master main</p>
</div></blockquote>
<p>rename <code class="docutils literal notranslate"><span class="pre">master</span></code> to <code class="docutils literal notranslate"><span class="pre">main</span></code></p>
</div>
<div class="section" id="rename-the-origin-remote-to-upstream">
<h2>Rename The <code class="docutils literal notranslate"><span class="pre">origin</span></code> Remote To <code class="docutils literal notranslate"><span class="pre">upstream</span></code><a class="headerlink" href="#rename-the-origin-remote-to-upstream" title="永久链接至标题">¶</a></h2>
<blockquote>
<div><p>$ git remote rename origin upstream</p>
</div></blockquote>
<p>You can also do this using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">remote</span> <span class="pre">set-url</span></code>, but it takes longer and is more steps.</p>
<p><a class="reference external" href="https://github.com/k88hudson/git-flight-rules#suggesting-code-via-pull-requests">source1</a></p>
</div>
<div class="section" id="reset">
<h2>Reset<a class="headerlink" href="#reset" title="永久链接至标题">¶</a></h2>
<p>Come back last commit, don’t delete commit content</p>
<blockquote>
<div><p>git reset –soft HEAD^</p>
</div></blockquote>
</div>
<div class="section" id="see-a-file-at-a-specific-commit">
<h2>See A File At A Specific Commit<a class="headerlink" href="#see-a-file-at-a-specific-commit" title="永久链接至标题">¶</a></h2>
<p><a class="reference external" href="https://github.com/k88hudson/git-flight-rules#what-did-i-just-commit">source2</a></p>
<blockquote>
<div><p>git show &lt;commitid&gt;:filename</p>
</div></blockquote>
</div>
<div class="section" id="show-helpful-guides-that-come-with-git">
<h2>Show Helpful Guides That Come With Git<a class="headerlink" href="#show-helpful-guides-that-come-with-git" title="永久链接至标题">¶</a></h2>
<blockquote>
<div><p>git help -g</p>
</div></blockquote>
<p><a class="reference external" href="https://github.com/git-tips/tips#show-helpful-guides-that-come-with-git">source3</a></p>
</div>
<div class="section" id="show-the-latest-commit">
<h2>Show The Latest Commit<a class="headerlink" href="#show-the-latest-commit" title="永久链接至标题">¶</a></h2>
<p><a class="reference external" href="https://github.com/k88hudson/git-flight-rules#what-did-i-just-commit">source4</a></p>
<blockquote>
<div><p>git show
# or
git log -n1 -p</p>
</div></blockquote>
</div>
<div class="section" id="use-format-patch-to-suggest-code-changes">
<h2>Use <code class="docutils literal notranslate"><span class="pre">format</span> <span class="pre">patch</span></code> To Suggest Code Changes<a class="headerlink" href="#use-format-patch-to-suggest-code-changes" title="永久链接至标题">¶</a></h2>
<blockquote>
<div><p>git format-patch HEAD^</p>
</div></blockquote>
<p><a class="reference external" href="https://github.com/k88hudson/git-flight-rules#suggesting-code-via-patches">source</a></p>
</div>
<div class="section" id="what-will-be-done-after-rename-branch-on-github">
<h2>What Will Be Done After Rename Branch On GitHub<a class="headerlink" href="#what-will-be-done-after-rename-branch-on-github" title="永久链接至标题">¶</a></h2>
<blockquote>
<div><p>git branch -m master main
git fetch origin
git branch -u origin/main main</p>
</div></blockquote>
</div>
<div class="section" id="commit-message">
<h2>commit message 规范<a class="headerlink" href="#commit-message" title="永久链接至标题">¶</a></h2>
<p>commit message 是必须要遵循一定的规范的，随意的 commit message 只会让人感受到不专业。这里我们参考 <a class="reference external" href="https://gist.github.com/stephenparish/9941e89d80e2bc58a153">AngularJS commit message conventions</a></p>
<blockquote>
<div><p>This would add kinda “context” information. Look at these messages (taken from last few angular’s commits):<span class="raw-html-m2r"><br></span>
Fix small typo in docs widget (tutorial instructions)<span class="raw-html-m2r"><br></span>
Fix test for scenario. Application - should remove old iframe<span class="raw-html-m2r"><br></span>
docs - various doc fixes<span class="raw-html-m2r"><br></span>
docs - stripping extra new lines<span class="raw-html-m2r"><br></span>
Replaced double line break with single when text is fetched from Google<span class="raw-html-m2r"><br></span>
Added support for properties in documentation</p>
</div></blockquote>
</div>
<div class="section" id="git-rebase-commit">
<h2>使用 git rebase 来合并你的 commit<a class="headerlink" href="#git-rebase-commit" title="永久链接至标题">¶</a></h2>
<p>大部分人在实际开发过程中，都会建立自己的分支开发，这是大部分团队都能做到的，但是我们在测试问题的时候总是会提交一些无用的 commit 去远程的 repo，自己的分支还好，但是最后把自己的分支合并到 master 上的时候如果还带上这些 commit 就十分不雅观了，当然 github 的 PR 功能已经给我们合并 PR 的时候提供了多种选项，其中就包括 rebase。但是这里还是要介绍一个很多人不常用的命令，git rebase，也就是变基，git rebase 功能很强大，也很容易一不小心弄不好就把你的整个 commit 或者 git 历史弄乱，所以这里我们不写如何用它来变基，只说如何用它来合并自己的 commit。<a class="reference external" href="http://gitbook.liuhui998.com/4_2.html">参考教程</a></p>
<p>注意事项：只有个人操作的分支才可以用 git rebase，多人一起协作的分支切记不要轻易使用 git rebase, 否则很容易造成冲突。</p>
<p>实战操作，首先建立一个 git 目录。</p>
<blockquote>
<div><p>$ mkdir testGit
$ git init
$ vim 1. txt</p>
</div></blockquote>
<p>在 master 分支对 1.txt 做修改并且 commit</p>
<a class="reference external image-reference" href="http://gw.alicdn.com/tfs/TB1luMFXBr0gK0jSZFnXXbRRXXa-1138-852.png"><img alt="" src="http://gw.alicdn.com/tfs/TB1luMFXBr0gK0jSZFnXXbRRXXa-1138-852.png" /></a>
<p>切换到 rebase 分支，修改两次 1.txt，并进行两次 commit</p>
<a class="reference external image-reference" href="http://gw.alicdn.com/tfs/TB1UWIFXBv0gK0jSZKbXXbK2FXa-1140-856.png"><img alt="" src="http://gw.alicdn.com/tfs/TB1UWIFXBv0gK0jSZKbXXbK2FXa-1140-856.png" /></a>
<p>使用 git rebase 合并刚刚的两次 commit</p>
<blockquote>
<div><p>$ git rebase - i HEAD~x # x 代表你要合并前 x 次 commit 这里我们填 2, 这里你也可以直接填具体的 commit 对应的 hash 值
$ git rebase - i HEAD~2</p>
</div></blockquote>
<a class="reference external image-reference" href="http://gw.alicdn.com/tfs/TB1Qs7DXAT2gK0jSZFkXXcIQFXa-1154-866.png"><img alt="" src="http://gw.alicdn.com/tfs/TB1Qs7DXAT2gK0jSZFkXXcIQFXa-1154-866.png" /></a>
<p>这里的 pick 的意思是</p>
<blockquote>
<div><p>pick：保留该 commit（缩写：p）<span class="raw-html-m2r"><br></span>
reword：保留该 commit，但我需要修改该 commit 的注释（缩写：r）<span class="raw-html-m2r"><br></span>
edit：保留该 commit, 但我要停下来修改该提交（不仅仅修改注释）（缩写：e）<span class="raw-html-m2r"><br></span>
squash：将该 commit 和前一个 commit 合并（缩写：s）<span class="raw-html-m2r"><br></span>
fixup：将该 commit 和前一个 commit 合并，但我不要保留该提交的注释信息（缩写：f）<span class="raw-html-m2r"><br></span>
exec：执行 shell 命令（缩写：x）<span class="raw-html-m2r"><br></span>
drop：我要丢弃该 commit（缩写：d）</p>
</div></blockquote>
<p>我们使用的比较多的是 <code class="docutils literal notranslate"><span class="pre">s</span></code> 和 <code class="docutils literal notranslate"><span class="pre">f</span></code> 两个选项，在这里我们想要合并两次 commit 为一个，所以将我们的 rebase 信息改为</p>
<p>保存之后出现如下界面，可以让我们设置合并后的 commit 信息，在第二行写上新的 cm 信息，并且注释掉之前的两次 cm 信息，或者直接用 dd 来删除</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">:wq</span></code> 保存后查看 git log</p>
</div></blockquote>
<p>ok, 前两次 cm 信息成功被合并为了一个</p>
<p>注意事项</p>
<p>你执行了 rebase 命令的分支如果和远程仓库的 commit history 不一样，是没有办法直接 push 到远程仓库的，因为这时候你本地仓库的 commit history 已经修改了，和远程的会冲突。</p>
<p>解决方式</p>
<blockquote>
<div><p>$ git push origin dev -f # 使用–force 来强制 push，但你要清楚这可能会导致你的一些 commit 记录的丢失，所以请仅在个人分支进行该操作</p>
</div></blockquote>
</div>
<div class="section" id="git-pull-rebase">
<h2><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span> <span class="pre">--rebase</span></code><a class="headerlink" href="#git-pull-rebase" title="永久链接至标题">¶</a></h2>
<p>使用该命令可以使用 commits 变得优美流畅，不会存在 merge commit。</p>
</div>
<div class="section" id="id4">
<h2>分支合并<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h2>
<div class="section" id="main">
<h3>场景：基于 main 分支代码，开发新特性<a class="headerlink" href="#main" title="永久链接至标题">¶</a></h3>
<p>如果直接在 main 分支开发，如果后续对 main 分支又有另外的开发任务，会导致 main 分支的 commits 很乱。所以，当我们开发新特性时，可以在一个新分支进行，待到新特性开发完毕，再整体合并到 main 分支中。</p>
<p>具体做法如下：</p>
<p>（1）基于 main 分支，新建一个分支，名为 <code class="docutils literal notranslate"><span class="pre">feature_item_recommend</span></code>：</p>
<blockquote>
<div><p>$ git checkout -b feature_item_recommend</p>
<p>Switched to a new branch ‘feature_item_recommend’</p>
</div></blockquote>
<p>上面这行命令，相当于：</p>
<blockquote>
<div><p>$ git branch feature_item_recommend # 创建新分支
$ git checkout feature_item_recommend # 切换到新分支</p>
</div></blockquote>
<p>（2）在新分支 <code class="docutils literal notranslate"><span class="pre">feature_item_recommend</span></code> 上，完成开发工作，并 commit，push。</p>
<p>（3）将新分支 <code class="docutils literal notranslate"><span class="pre">feature_item_recommend</span></code> 上的代码<strong>合并</strong>到 main 分支：</p>
<blockquote>
<div><p>$ git checkout main # 切换到 main 分支
$ git merge feature_item_recommend # 合并</p>
</div></blockquote>
<p>合并后，<code class="docutils literal notranslate"><span class="pre">main</span></code> 分支和 <code class="docutils literal notranslate"><span class="pre">feature_item_recommend</span></code> 分支会指向同一位置。</p>
<p>（4）删除已合并分支 <code class="docutils literal notranslate"><span class="pre">feature_item_recommend</span></code>：</p>
<blockquote>
<div><p>$ git branch -d feature_item_recommend</p>
</div></blockquote>
<p>注意，当前仓库处于 <code class="docutils literal notranslate"><span class="pre">main</span></code> 分支，可以用以上命令删除目标分支。如果当前所处分支是 <code class="docutils literal notranslate"><span class="pre">feature_item_recommend</span></code>，则无法删除 <code class="docutils literal notranslate"><span class="pre">feature_item_recommend</span></code>。</p>
</div>
<div class="section" id="id5">
<h3>场景：合并分支时，存在分叉<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h3>
<a class="reference external image-reference" href="https://cdn.jsdelivr.net/gh/tianheg/static&#64;main/img/git-merge.png"><img alt="git-merge.png" src="https://cdn.jsdelivr.net/gh/tianheg/static&#64;main/img/git-merge.png" /></a>
<p>最早 main 分支位于 <code class="docutils literal notranslate"><span class="pre">C2</span></code> 节点，基于 <code class="docutils literal notranslate"><span class="pre">C2</span></code> 节点新建分支 <code class="docutils literal notranslate"><span class="pre">iss53</span></code>，然后在 <code class="docutils literal notranslate"><span class="pre">iss53</span></code> commit。</p>
<p>现在，准备合并 <code class="docutils literal notranslate"><span class="pre">iss53</span></code> 的两个 commits：<code class="docutils literal notranslate"><span class="pre">C3</span></code>、<code class="docutils literal notranslate"><span class="pre">C5</span></code>，到 main 分支。但是，main 分支已经前进到 <code class="docutils literal notranslate"><span class="pre">C4</span></code>。这是该如何把 <code class="docutils literal notranslate"><span class="pre">iss53</span></code> 合并到 main 分支呢？</p>
<blockquote>
<div><p>$ git checkout main
$ git merge iss53</p>
</div></blockquote>
<p><strong>解释</strong>：</p>
<p>这次合并不同于上一小节的简单合并，这一次，开发历史是从更早的 commit 开始分叉的。由于当前 main 分支指向的 commit(C4) 不是想要并入分支 <code class="docutils literal notranslate"><span class="pre">iss53</span></code> 的直接祖先，Git 需要进行处理。对于这个例子，Git 会用两个分支的末端（C4，C5）和它们的共同祖先（C2）进行一次简单的三方合并计算：</p>
<p>Git 没有简单的把分支指针右移，而是对三方合并的结果作一新的快照，并自动创建一个指向它的 commit（C6）（如下图所示）。我们把这个特殊的 commit 称作<strong>合并提交</strong>（merge commit），因为它的祖先不止一个。</p>
<a class="reference external image-reference" href="https://cdn.jsdelivr.net/gh/tianheg/static&#64;main/img/git-merge-1.png"><img alt="git-merge-1.png" src="https://cdn.jsdelivr.net/gh/tianheg/static&#64;main/img/git-merge-1.png" /></a>
</div>
<div class="section" id="id6">
<h3>场景：解决合并冲突<a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h3>
<a class="reference external image-reference" href="https://cdn.jsdelivr.net/gh/tianheg/static&#64;main/img/git-merge-2.png"><img alt="git-merge-2.png" src="https://cdn.jsdelivr.net/gh/tianheg/static&#64;main/img/git-merge-2.png" /></a>
<p>如果 feature1 和 feature2 修改的是同一个文件中<strong>代码的同一个位置</strong>，那么当把 feature2 合并到 feature1 时，就会产生冲突。这个冲突需要手动解决：</p>
<p>（1）对两个分支对相同区域的修改，进行检查，判断如何处理，并取消冲突。</p>
<p>（2）<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code>：解决冲突后，通过 <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">status</span></code> 得到 <code class="docutils literal notranslate"><span class="pre">Unmerged</span> <span class="pre">paths</span></code>。然后，<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code>，<strong>冲突解决，加入存取区</strong>。</p>
<p>（3）<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span></code>：提交。</p>
<p>然后，可以继续把 feature1 合并到 main（此时，feature1 和 feature2 指向同一个 commit），最后删除 feature1，feature2。</p>
<p><strong>注意</strong>：两个分支的同一个文件的不同地方合并时，Git 会自动完成，不会产生冲突。</p>
<p>不论是自动合并还是手动合并，提交之前，都要对代码进行测试。</p>
</div>
</div>
<div class="section" id="id7">
<h2>其他<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h2>
<div class="section" id="id8">
<h3>修改密码<a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h3>
<blockquote>
<div><p>$ git config user.name “”</p>
</div></blockquote>
<p>然后，当我们再输入 <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span></code> 等命令行时，就会被要求重新输入<em>新的</em>账号密码。此时，密码就可以修改成功了。最后，我们还要输入如下命令，还原当前仓库的用户名：</p>
<blockquote>
<div><p>$ git config user.name “username”</p>
</div></blockquote>
</div>
<div class="section" id="push-commit">
<h3>修改已经 push 的某次 commit 的作者/邮箱<a class="headerlink" href="#push-commit" title="永久链接至标题">¶</a></h3>
<p>已经 push 的记录，如果要修改作者信息的话，只能通过 –force 命令。</p>
<p>下面是来自 <a class="reference external" href="https://stackoverflow.com/a/750182/12539782">这里</a> 的脚本：</p>
<blockquote>
<div><p>#!/bin/sh</p>
<p>git filter-branch –env-filter ‘
OLD_EMAIL=”<a class="reference external" href="mailto:your-old-email&#37;&#52;&#48;example&#46;com">your-old-email<span>&#64;</span>example<span>&#46;</span>com</a>”
CORRECT_NAME=”Your Correct Name”
CORRECT_EMAIL=”<a class="reference external" href="mailto:your-correct-email&#37;&#52;&#48;example&#46;com">your-correct-email<span>&#64;</span>example<span>&#46;</span>com</a>”
if [ “$GIT_COMMITTER_EMAIL” = “$OLD_EMAIL” ]
then</p>
<blockquote>
<div><p>export GIT_COMMITTER_NAME=”$CORRECT_NAME”
export GIT_COMMITTER_EMAIL=”$CORRECT_EMAIL”</p>
</div></blockquote>
<p>fi
if [ “$GIT_AUTHOR_EMAIL” = “$OLD_EMAIL” ]
then</p>
<blockquote>
<div><p>export GIT_AUTHOR_NAME=”$CORRECT_NAME”
export GIT_AUTHOR_EMAIL=”$CORRECT_EMAIL”</p>
</div></blockquote>
<p>fi
‘ –tag-name-filter cat – –branches –tags</p>
</div></blockquote>
<p>其他方法：</p>
<blockquote>
<div><p>$ git filter-branch -f –env-filter “GIT_AUTHOR_NAME=’Newname’; GIT_AUTHOR_EMAIL=’newemail’; GIT_COMMITTER_NAME=’committed-name’; GIT_COMMITTER_EMAIL=’committed-email’;” HEAD
# <a class="reference external" href="https://stackoverflow.com/a/2920001/12539782">https://stackoverflow.com/a/2920001/12539782</a></p>
</div></blockquote>
<p><strong>修改 author</strong>：</p>
<blockquote>
<div><p>$ git rebase -i HEAD~n # 表示要修改前 n 次所有的提交</p>
</div></blockquote>
<p>输入此命令后，显示以下结果：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pick ac0fcc6 add file2
pick a0cbfbe add file3
pick 16ee6eb add file4

# Rebase d57f11f..16ee6eb onto d57f11f (3 command(s))
#
# Commands:
# p, pick = use commit
# r, reword = use commit, but edit the commit message
# e, edit = use commit, but stop for amending
# s, squash = use commit, but meld into previous commit
# f, fixup = like &quot;squash&quot;, but discard this commit&#39;s log message
# x, exec = run command (the rest of the line) using shell
</pre></div>
</div>
<p>我们要修改第二行和第三行的提交，根据提示，因此把第二行和第三行的 pick 改成 edit 或 e，保存退出。</p>
<p>保存上面的修改并退出后，git 会依次执行上面的操作，当操作为 pick 时，直接 commit。当操作为 edit 时，会中断，并提示以下信息：</p>
<blockquote>
<div><p>You can amend the commit now, with</p>
<blockquote>
<div><p>git commit –amend</p>
</div></blockquote>
<p>Once you are satisfied with your changes, run</p>
<blockquote>
<div><p>git rebase –continue</p>
</div></blockquote>
</div></blockquote>
<p>这里的意思是说，你可以使用 <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">--amend</span></code> 来修改此次提交，修改以后，觉得满意了，执行 <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rebase</span> <span class="pre">--continue</span></code> 继续剩下的流程。</p>
<p>由于我们的主要目的是修改提交者的信息，因此光用 <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">--amend</span></code> 是不够的，我们要使用 <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">--amend</span> <span class="pre">--author</span> <span class="pre">&quot;yourname</span> <span class="pre">&lt;your</span> <span class="pre">email&gt;&quot;</span></code> 这样的操作，这一点是修改提交者信息的关键所在。</p>
<p>使用上面的命令成功修改此次提交的提交者信息后，一定要记得执行 <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rebase</span> <span class="pre">--continue</span></code> 继续。</p>
<p>最终完成以后提示如下：</p>
<blockquote>
<div><p>$ git rebase –continue
Successfully rebased and updated refs/heads/master.</p>
</div></blockquote>
<p>相关讨论：</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://stackoverflow.com/q/750172/12539782">https://stackoverflow.com/q/750172/12539782</a></p></li>
<li><p><a class="reference external" href="https://segmentfault.com/q/1010000006999861">git 修改已提交的某一次的邮箱和用户信息</a></p></li>
<li><p><a class="reference external" href="http://baurine.github.io/2015/08/22/git_update_author.html">修改 git repo 历史提交的 author</a></p></li>
</ol>
</div>
<div class="section" id="branch1-commit1-branch2">
<h3>将 <code class="docutils literal notranslate"><span class="pre">branch1</span></code> 的某个 <code class="docutils literal notranslate"><span class="pre">commit1</span></code> 合并到 <code class="docutils literal notranslate"><span class="pre">branch2</span></code> 当中<a class="headerlink" href="#branch1-commit1-branch2" title="永久链接至标题">¶</a></h3>
<p>切换到 branch2 中，然后执行如下命令：</p>
<blockquote>
<div><p>$ git cherry-pick commit1</p>
</div></blockquote>
</div>
<div class="section" id="id10">
<h3>将 Git 项目迁移到另一个仓库<a class="headerlink" href="#id10" title="永久链接至标题">¶</a></h3>
<p>我们假设旧仓库的项目名称叫 <code class="docutils literal notranslate"><span class="pre">old-repository</span></code>，新仓库的项目名称叫 <code class="docutils literal notranslate"><span class="pre">new-repository</span></code>。操作如下：</p>
<p>（1）创建旧仓库的裸克隆：</p>
<blockquote>
<div><p>git clone –bare <a class="reference external" href="https://github.com/exampleuser/old-repository.git">https://github.com/exampleuser/old-repository.git</a></p>
</div></blockquote>
<p>执行上述命令后，会在本地生成一个名叫 <code class="docutils literal notranslate"><span class="pre">old-repository.git</span></code>的文件夹。</p>
<p>（2）迁移到新仓库：</p>
<blockquote>
<div><p>cd old-repository.git
git push –mirror <a class="reference external" href="https://github.com/exampleuser/new-repository.git">https://github.com/exampleuser/new-repository.git</a></p>
</div></blockquote>
<p>这样的话，项目就已经迁移到新仓库了。</p>
<p>注意，我们<strong>不需要</strong>手动新建一个空的新仓库，当我们执行上述命令之后，新仓库就已经自动创建好了。</p>
<p>参考链接：</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/duplicating-a-repository">Duplicating a repository</a></p></li>
<li><p><a class="reference external" href="https://moelove.info/2016/12/04/Git-%E6%9C%AC%E5%9C%B0%E4%BB%93%E5%BA%93%E5%92%8C%E8%A3%B8%E4%BB%93%E5%BA%93/">Git 本地仓库和裸仓库</a></p></li>
</ol>
<hr class="docutils" />
<p><strong>参考资料</strong>：</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://git-scm.com/">https://git-scm.com/</a></p></li>
</ol>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="branch-name-contain-the-space-char.html" class="btn btn-neutral float-right" title="Branch Name Contain The ‘space’ Char" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="git-glossary.html" class="btn btn-neutral float-left" title="Git Glossary" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; 版权所有 2021, Jim Gao.

    </p>
  </div>
    
    
    
    利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用了 
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    
    由 <a href="https://readthedocs.org">Read the Docs</a>开发.
<p>除额外注明的地方外，本文档按 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议发布。</p>
 


</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>